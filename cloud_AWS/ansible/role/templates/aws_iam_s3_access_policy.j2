{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AllowToSeeBucketList",
      "Action": [
        "s3:ListBucket",
        "s3:HeadBucket"
      ],
      "Effect": "Allow",
      "Resource": [
{% if s3_flowlogs_bucket %}
        "arn:aws:s3:::{{ s3_flowlogs_bucket }}"
{% else %}
{% for v in vpc_id_list %}
        "arn:aws:s3:::{{ s3_bucket_prefix }}-{{ v }}-flow-logs"{{ ',' if not loop.last else '' }}
{% endfor %}
{% endif %}
      ]
    },
    {
      "Sid": "AllowToOperateOnTheBucket",
      "Effect": "Allow",
{% if rw_s3_access is sameas true %}
      "Action": "s3:*",
{% else %}
      "Action": [
        "s3:Get*",
        "s3:List*",
      ],
{% endif %}
      "Resource": [
{% if s3_flowlogs_bucket %}
        "arn:aws:s3:::{{ s3_flowlogs_bucket }}/*"
{% else %}
{% for v in vpc_id_list %}
        "arn:aws:s3:::{{ s3_bucket_prefix }}-{{ v }}-flow-logs/*"{{ ',' if not loop.last else '' }}
{% endfor %}
{% endif %}
      ]
    }
  ]
}
